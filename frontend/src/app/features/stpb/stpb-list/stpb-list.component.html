<app-page-header title="Surat Tanda Pertanggungjawaban Belanja (STPB)" subtitle="Daftar STPB">
  <button nz-button nzType="primary" (click)="createNew()">
    <span nz-icon nzType="plus"></span>
    Tambah STPB
  </button>
</app-page-header>

<div class="search-container">
  <nz-input-group [nzSuffix]="suffixIconSearch">
    <input 
      type="text" 
      nz-input 
      placeholder="Cari nomor STPB..." 
      [(ngModel)]="searchTerm" 
      (keyup.enter)="onSearch()" 
    />
  </nz-input-group>
  <ng-template #suffixIconSearch>
    <span nz-icon nzType="search" (click)="onSearch()" style="cursor: pointer;"></span>
  </ng-template>
</div>

<nz-table 
  #basicTable 
  [nzData]="stpbs" 
  [nzLoading]="loading"
  [nzFrontPagination]="false"
  [nzTotal]="total"
  [nzPageSize]="pageSize"
  [nzPageIndex]="pageIndex"
  (nzPageIndexChange)="onPageChange($event)">
  <thead>
    <tr>
      <th>Nomor STPB</th>
      <th>Tanggal</th>
      <th>Deskripsi</th>
      <th>Nilai Total</th>
      <th>Status</th>
      <th>Dibuat Oleh</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of basicTable.data">
      <td>{{ data.nomorSTPB }}</td>
      <td>{{ data.tanggal | date: 'dd/MM/yyyy' }}</td>
      <td>{{ data.deskripsi || '-' }}</td>
      <td>{{ data.nilaiTotal | currency: 'IDR' }}</td>
      <td>
        <nz-tag [nzColor]="getStatusColor(data.status)">{{ data.status }}</nz-tag>
      </td>
      <td>{{ data.creatorName }}</td>
      <td>
        <button nz-button nzType="link" nzSize="small" (click)="edit(data.id)">
          <span nz-icon nzType="edit"></span>
        </button>
        <button nz-button nzType="link" nzSize="small" nzDanger (click)="delete(data.id, data.nomorSTPB)">
          <span nz-icon nzType="delete"></span>
        </button>
      </td>
    </tr>
  </tbody>
</nz-table>
